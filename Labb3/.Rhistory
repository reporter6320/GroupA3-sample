ggplot(numeric_data,aes(NewCases))+geom_histogram(bins=40)
ggplot(data, aes(x = AgeGroup, y = NewCases, fill = AgeGroup)) +
geom_boxplot() +
theme_minimal() +
labs(title = "NewCases by Age Group",
x = "Age Group",
y = "NewCases") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
ggplot(data, aes(x = Sex, y = NewCases, fill = Sex)) +
geom_boxplot() +
theme_minimal() +
labs(title = "NewCases by Sex",
x = "Sex",
y = "NewCases") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
ggplot(data, aes(x = Region, y = NewCases, fill = Region)) +
geom_boxplot() +
theme_minimal() +
labs(title = "NewCases by Region",
x = "Region",
y = "NewCases") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
library(ggpubr)   # for correlation annotation
install.packages("ggpubr")
library(ggpubr)   # for correlation annotation
ggplot(data, aes(x = BMImedian, y = CLIstd)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(dat$Var1, na.rm=TRUE),
label.y = 0.9*max(dat$Var2, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between Var1 and Var2",
x = "Variable 1",
y = "Variable 2")
ggplot(data, aes(x = BMImedian, y = CLIstd)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(data$BMImedian, na.rm=TRUE),
label.y = 0.9*max(data$CLIstd, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between Var1 and Var2",
x = "Variable 1",
y = "Variable 2")
library(ggpubr)   # for correlation annotation
ggplot(data, aes(x = BMImedian, y = CLIstd)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(data$BMImedian, na.rm=TRUE),
label.y = 0.9*max(data$CLIstd, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between BMImedian and CLIstd",
x = "BMImedian",
y = "CLIstd")
ggplot(data, aes(x = CLIstd, y = NewCases)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(data$CLIstd, na.rm=TRUE),
label.y = 0.9*max(data$NewCases, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between CLIstd and NewCases",
x = "CLIstd",
y = "NewCases")
ggplot(data, aes(x = Region, y = BMImedian, fill = Region)) +
geom_boxplot() +
theme_minimal() +
labs(title = "BMImedian by Region",
x = "Region",
y = "BMImedian") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
#Start fitting models
library(car)
library(DHARMa)
library(interactions)
install.packages(interactions)
install.packages("interactions")
library(rsq)
install.packages("rsq")
model1 <- glm(NewCases ~ SexNum + AgeGroupNum + RegionNum+ CLIstd + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model1)
BIC(model)
BIC(model1)
rsq(model1, adj=TRUE)  # pseudo-R² for GLMs
library(rsq)
rsq(model1, adj=TRUE)  # pseudo-R² for GLMs
sim_res <- simulateResiduals(fittedModel = model)
sim_res <- simulateResiduals(fittedModel = model1)
plot(sim_res)
testDispersion(sim_res)
testZeroInflation(sim_res)
interact_plot(model1, pred = "CLIstd", modx = "Sex")
library(interactions)
interact_plot(model1, pred = "CLIstd", modx = "Sex")
interact_plot(model1, pred = "CLIstd", modx = "SexNum")
model2 <- glm(NewCases ~ SexNum + AgeGroupNum + CLIstd*RegionNum + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model2)
BIC(model2)
rsq(model2, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model2, pred = "CLIstd", modx = "RegionNum")
model3 <- glm(NewCases ~ AgeGroupNum + CLIstd*SexNum + RegionNum + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model3)
BIC(model3)
rsq(model3, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model3, pred = "CLIstd", modx = "SexNum")
model4 <- glm(NewCases ~ AgeGroupNum + CLIstd*BMImedia + SexNum + RegionNum + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
model4 <- glm(NewCases ~ AgeGroupNum + CLIstd*BMImedian + SexNum + RegionNum + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model4)
BIC(model4)
rsq(model4, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model4, pred = "CLIstd", modx = "SexNum")
interact_plot(model4, pred = "CLIstd", modx = "BMImedian")
model5 <- glm(NewCases ~ AgeGroupNum + CLIst+BMImedian + SexNum + RegionNum + Npopulation + SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
model5 <- glm(NewCases ~ AgeGroupNum + CLIstd +BMImedian + SexNum + RegionNum + Npopulation + SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model5)
BIC(model5)
rsq(model5, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model5, pred = "CLIstd", modx = "BMImedian")
model6 <- glm(NewCases ~ AgeGroupNum + CLIstd*SexNum +BMImedian + RegionNum + Npopulation + SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model6)
BIC(model6)
rsq(model6, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model6, pred = "CLIstd", modx = "SexNum")
model7 <- glm(NewCases ~ AgeGroupNum + CLIstd*SexNum +BMImedian + Npopulation + SmokingPrevalence*RegionNum,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model7)
BIC(model7)
rsq(model7, adj=TRUE)  # pseudo-R² for GLMs
model7 <- glm(NewCases ~ AgeGroupNum + CLIstd + SexNum +BMImedian + Npopulation + SmokingPrevalence*RegionNum,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model7)
BIC(model7)
model7 <- glm(NewCases ~ AgeGroupNum + CLIstd*SexNum +BMImedian + SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model7)
BIC(model7)
rsq(model7, adj=TRUE)  # pseudo-R² for GLMs
library(glmnet)
install.packages("glmnet")
library(glmnet)
# Create matrix of predictors (without response)
X <- model.matrix(~ AgeGroupNum + CLIstd * SexNum + BMImedian + SmokingPrevalence, data = numeric_data)[, -1]
# Response
y <- numeric_data$NewCases
# Offset
offset_var <- log(numeric_data$Npopulation)
set.seed(123)
cv_lasso <- cv.glmnet(X, y,
family = "poisson",
offset = offset_var,
alpha = 1)  # alpha = 1 → LASSO
plot(cv_lasso)
cv_lasso$lambda.min     # lambda that minimizes cross-validation error
cv_lasso$lambda.1se     # simpler model (within 1 SE of min)
coef(cv_lasso, s = "lambda.min")
coef(cv_lasso, s = "lambda.1se")
model8 <- glm(NewCases ~ AgeGroupNum + CLIstd+SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model8)
#Explore the dataset
data <- read.csv("Data_T1.csv")
str(data)
head(data)
summary(data)
colSums(is.na(data))
library(GGally)
continous_data <- data[, sapply(data, is.numeric)]
ggpairs(continous_data)
data$Region <- factor(data$Region,
levels = c("Region1", "Region2", "Region3", "Region4", "Region5"))
data$AgeGroup <- factor(data$AgeGroup,
levels = c("20-39", "40-59", "60-79"))
data$Sex <- factor(data$Sex,
levels = c("Male", "Female"))
data$RegionNum <- as.numeric(data$Region)     # 1–5
data$AgeGroupNum <- as.numeric(data$AgeGroup) # 1–3
data$SexNum <- as.numeric(data$Sex)           # male = 1, female = 2
str(data)
head(data)
summary(data)
numeric_cols <- sapply(data, is.numeric)
numeric_data <- data[, numeric_cols]
library(corrplot)
cor_dat = cor(numeric_data)
corrplot(cor_dat)
ggpairs(numeric_data)
#Explore the dataset
data <- read.csv("Data_T1.csv")
str(data)
head(data)
summary(data)
colSums(is.na(data)) #Check for missing data
library(GGally)
ggpairs(data)
data$Region <- factor(data$Region,
levels = c("Region1", "Region2", "Region3", "Region4", "Region5"))
#Convert the nonnumerical values to numerical
data$Region <- factor(data$Region,
levels = c("Region1", "Region2", "Region3", "Region4", "Region5"))
data$AgeGroup <- factor(data$AgeGroup,
levels = c("20-39", "40-59", "60-79"))
data$Sex <- factor(data$Sex,
levels = c("Male", "Female"))
data$RegionNum <- as.numeric(data$Region)     # 1–5
data$AgeGroupNum <- as.numeric(data$AgeGroup) # 1–3
data$SexNum <- as.numeric(data$Sex)           # male = 1, female = 2
str(data)
head(data)
summary(data)
numeric_cols <- sapply(data, is.numeric)
numeric_data <- data[, numeric_cols]
library(corrplot)
cor_dat = cor(numeric_data)
corrplot(cor_dat)
boxplot(BMImedian ~ Sex, data = data)
ggplot(numeric_data,aes(NewCases))+geom_histogram(bins=40)
ggplot(data, aes(x = AgeGroup, y = NewCases, fill = AgeGroup)) +
geom_boxplot() +
theme_minimal() +
labs(title = "NewCases by Age Group",
x = "Age Group",
y = "NewCases") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
ggplot(data, aes(x = Sex, y = NewCases, fill = Sex)) +
geom_boxplot() +
theme_minimal() +
labs(title = "NewCases by Sex",
x = "Sex",
y = "NewCases") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
ggplot(data, aes(x = Region, y = NewCases, fill = Region)) +
geom_boxplot() +
theme_minimal() +
labs(title = "NewCases by Region",
x = "Region",
y = "NewCases") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
library(ggpubr)   # for correlation annotation
#NewCases vs continous variabels
ggplot(data, aes(x = CLIstd, y = NewCases)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(data$CLIstd, na.rm=TRUE),
label.y = 0.9*max(data$NewCases, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between CLIstd and NewCases",
x = "CLIstd",
y = "NewCases")
ggplot(data, aes(x = Npopulation, y = NewCases)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(data$Npopulation, na.rm=TRUE),
label.y = 0.9*max(data$NewCases, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between Npopulation and NewCases",
x = "Npopulation",
y = "NewCases")
ggplot(data, aes(x = SmokingPrevalence, y = NewCases)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(data$SmokingPrevalence, na.rm=TRUE),
label.y = 0.9*max(data$NewCases, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between SmokingPrevalence and NewCases",
x = "SmokingPrevalence",
y = "NewCases")
ggplot(data, aes(x = BMImedian , y = NewCases)) +
geom_point(color = "steelblue", alpha = 0.6) +        # scatter points
geom_smooth(method = "lm", color = "red", se = TRUE) + # regression line
stat_cor(method = "spearman", label.x = 0.7*max(data$BMImedian , na.rm=TRUE),
label.y = 0.9*max(data$NewCases, na.rm=TRUE)) +   # adds correlation r & p-value
theme_minimal() +
labs(title = "Relationship between BMImedian  and NewCases",
x = "BMImedian ",
y = "NewCases")
#Intervariable correlation
ggplot(data, aes(x = Region, y = BMImedian, fill = Region)) +
geom_boxplot() +
theme_minimal() +
labs(title = "BMImedian by Region",
x = "Region",
y = "BMImedian") +
scale_fill_brewer(palette = "Pastel1") +
theme(legend.position = "none")
cor_dat = cor(numeric_data)
corrplot(cor_dat)
#Start fitting models
library(car)
library(DHARMa)
library(interactions)
library(rsq)
#Model 1 : using all predictors
model1 <- glm(NewCases ~ SexNum + AgeGroupNum + RegionNum+ CLIstd + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model1)
BIC(model1)
rsq(model1, adj=TRUE)
model10 <- glm(NewCases ~ Sex + AgeGroup + Region+ CLIstd + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
model10 <- glm(NewCases ~ Sex + AgeGroup + Region+ CLIstd + BMImedian + Npopulation + SmokingPrevalence,
data = data, family = gaussian)
summary(model10)
BIC(model10)
rsq(model10, adj=TRUE)
#Model 2: Using CLIstd*RegionNum as an iteraction term
model2 <- glm(NewCases ~ Sex + AgeGroup + CLIstd*Region + BMImedian + Npopulation + SmokingPrevalence,
data = data, family = gaussian)
summary(model2)
BIC(model2)
rsq(model2, adj=TRUE)
#Model 3: Using CLIstd*SexNum as an interaction term
model3 <- glm(NewCases ~ AgeGroup + CLIstd*Sex + Region + BMImedian + Npopulation + SmokingPrevalence,
data = data, family = gaussian)
summary(model3)
BIC(model3)
rsq(model3, adj=TRUE)
interact_plot(model3, pred = "CLIstd", modx = "Sex")
#Model 5: Using a poisson: The offset adjusts for population size
model5 <- glm(NewCases ~ AgeGroup + CLIstd +BMImedian + Sex + Region + Npopulation + SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
#Model 5: Using a poisson: The offset adjusts for population size
model5 <- glm(NewCases ~ AgeGroup + CLIstd +BMImedian + Sex + Region + Npopulation + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model5)
BIC(model5)
rsq(model5, adj=TRUE)  # pseudo-R² for GLMs
#Model 5: Using a poisson: The offset adjusts for population size
model5 <- glm(NewCases ~ AgeGroup + CLIstd +BMImedian + Sex + Region + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model5)
BIC(model5)
rsq(model5, adj=TRUE)
#Model 6: Using CLIstd*SexNum as an interaction term + poisson
model6 <- glm(NewCases ~ AgeGroup + CLIstd*Sex +BMImedian + Region + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model6)
BIC(model6)
rsq(model6, adj=TRUE)
interact_plot(model6, pred = "CLIstd", modx = "Sex")
#Model 1 : using all predictors
model1 <- glm(NewCases ~ Sex + AgeGroup + Region+ CLIstd + BMImedian + Npopulation + SmokingPrevalence,
data = data, family = gaussian)
summary(model1)
BIC(model1)
rsq(model1, adj=TRUE)
#Model 2: Using CLIstd*RegionNum as an interaction term
model2 <- glm(NewCases ~ Sex + AgeGroup + CLIstd*Region + BMImedian + Npopulation + SmokingPrevalence,
data = data, family = gaussian)
summary(model2)
BIC(model2)
rsq(model2, adj=TRUE)
interact_plot(model2, pred = "CLIstd", modx = "RegionNum")
#Model 3: Using CLIstd*SexNum as an interaction term
model3 <- glm(NewCases ~ AgeGroup + CLIstd*Sex + Region + BMImedian + Npopulation + SmokingPrevalence,
data = data, family = gaussian)
summary(model3)
BIC(model3)
rsq(model3, adj=TRUE)
interact_plot(model3, pred = "CLIstd", modx = "Sex")
#Model 4: Using CLIstd*BMImedian as an interaction term
model4 <- glm(NewCases ~ AgeGroup + CLIstd*BMImedian + Sex+ Region + Npopulation + SmokingPrevalence,
data = data, family = gaussian)
summary(model4)
BIC(model4)
rsq(model4, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model4, pred = "CLIstd", modx = "BMImedian")
#Model 5: Using a poisson: The offset adjusts for population size with all predictors
model5 <- glm(NewCases ~ AgeGroup + CLIstd +BMImedian + Sex + Region + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model5)
BIC(model5)
rsq(model5, adj=TRUE)
#Model 6: Using CLIstd*SexNum as an interaction term + poisson
model6 <- glm(NewCases ~ AgeGroup + CLIstd*Sex +BMImedian + Region + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model6)
BIC(model6)
rsq(model6, adj=TRUE)
interact_plot(model6, pred = "CLIstd", modx = "Sex")
#Model 6: Using CLIstd*BMImedian as an interaction term + poisson
model7 <- glm(NewCases ~ AgeGroup + Sex +CLIstd*BMImedian + SmokingPrevalence,
data = ndata, family = poisson(link="log"), offset = log(Npopulation))
#Model 6: Using CLIstd*BMImedian as an interaction term + poisson
model7 <- glm(NewCases ~ AgeGroup + Sex +CLIstd*BMImedian + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model7)
BIC(model7)
rsq(model7, adj=TRUE)  # pseudo-R² for GLMs
#Model 6: Using CLIstd*BMImedian as an interaction term + poisson
model7 <- glm(NewCases ~ AgeGroup + Sex +CLIstd*BMImedian + Region+ SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model7)
BIC(model7)
rsq(model7, adj=TRUE)  # pseudo-R² for GLMs
#Model 6: Using CLIstd*BMImedian as an interaction term + poisson
model7 <- glm(NewCases ~ AgeGroupNum + SexNum +CLIstd*BMImedian + RegionNum+ SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model7)
BIC(model7)
rsq(model7, adj=TRUE)  # pseudo-R² for GLMs
#Model 1 : using all predictors
model1 <- glm(NewCases ~ SexNum + AgeGroupNum + RegionNum+ CLIstd + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model1)
BIC(model1)
rsq(model1, adj=TRUE)
#Model 2: Using CLIstd*RegionNum as an interaction term
model2 <- glm(NewCases ~ SexNum + AgeGroupNum + CLIstd*RegionNum + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model2)
BIC(model2)
rsq(model2, adj=TRUE)
interact_plot(model2, pred = "CLIstd", modx = "RegionNum")
#Model 3: Using CLIstd*SexNum as an interaction term
model3 <- glm(NewCases ~ AgeGroupNum + CLIstd*SexNum + RegionNum + BMImedian + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model3)
BIC(model3)
rsq(model3, adj=TRUE)
interact_plot(model3, pred = "CLIstd", modx = "SexNum")
#Model 4: Using CLIstd*BMImedian as an interaction term
model4 <- glm(NewCases ~ AgeGroupNum + CLIstd*BMImedian + SexNum+ RegionNum + Npopulation + SmokingPrevalence,
data = numeric_data, family = gaussian)
summary(model4)
BIC(model4)
rsq(model4, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model4, pred = "CLIstd", modx = "BMImedian")
#Model 5: Using a poisson: The offset adjusts for population size with all predictors
model5 <- glm(NewCases ~ AgeGroupNum + CLIstd +BMImedian + Sex + Region + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model5)
BIC(model5)
rsq(model5, adj=TRUE)
#Model 6: Using CLIstd*Sex as an interaction term + poisson
model6 <- glm(NewCases ~ AgeGroupNum + CLIstd*SexNum +BMImedian + RegionNum + SmokingPrevalence,
data = data, family = poisson(link="log"), offset = log(Npopulation))
summary(model6)
BIC(model6)
rsq(model6, adj=TRUE)
interact_plot(model6, pred = "CLIstd", modx = "SexNum")
#Model 6: Using CLIstd*BMImedian as an interaction term + poisson
model7 <- glm(NewCases ~ AgeGroupNum + SexNum +CLIstd*BMImedian + RegionNum+ SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model7)
BIC(model7)
rsq(model7, adj=TRUE)  # pseudo-R² for GLMs
interact_plot(model6, pred = "CLIstd", modx = "BMImedian")
# Create a list of models
model_list <- list(
model1 = model1,
model2 = model2,
model3 = model3,
model4 = model4,
model5 = model5,
model6 = model6,
model7 = model7
)
# Initialize empty data frame
model_summary <- data.frame(
Model = character(),
AIC = numeric(),
BIC = numeric(),
Rsq_adj = numeric(),
stringsAsFactors = FALSE
)
# Loop over models to fill the summary
for (i in seq_along(model_list)) {
m <- model_list[[i]]
model_summary <- rbind(model_summary, data.frame(
Model = names(model_list)[i],
AIC = AIC(m),
BIC = BIC(m),
Rsq_adj = rsq(m, adj = TRUE)  # pseudo-R² for GLMs
))
}
# Print summary table
print(model_summary)
library(glmnet)
# Create matrix of predictors (without response)
X <- model.matrix(~ AgeGroupNum + CLIstd * SexNum + BMImedian + SmokingPrevalence, data = numeric_data)[, -1]
# Response
y <- numeric_data$NewCases
# Offset
offset_var <- log(numeric_data$Npopulation)
set.seed(123)
cv_lasso <- cv.glmnet(X, y,
family = "poisson",
offset = offset_var,
alpha = 1)  # alpha = 1 → LASSO
plot(cv_lasso)
cv_lasso$lambda.min     # lambda that minimizes cross-validation error
cv_lasso$lambda.1se     # simpler model (within 1 SE of min)
coef(cv_lasso, s = "lambda.min")
coef(cv_lasso, s = "lambda.1se")
model8 <- glm(NewCases ~ AgeGroupNum + CLIstd+SmokingPrevalence,
data = numeric_data, family = poisson(link="log"), offset = log(Npopulation))
summary(model8)
BIC(model8)
rsq(model8, adj=TRUE)
